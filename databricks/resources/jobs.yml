# databricks/resources/jobs.yml
# Smoke job definition for CI/CD validation
# This job is intentionally lightweight and environment-agnostic.
# It is invoked by GitHub Actions via:
#   databricks bundle run smoke --target <env>

resources:
  jobs:
    smoke:
      name: smoke-${bundle.target}
      tags:
        purpose: ci-smoke
        environment: ${bundle.target}
      tasks:
        - task_key: smoke_notebook
          description: Lightweight smoke test to validate compute plane execution
          notebook_task:
            notebook_path: resources/notebooks/smoke_tests/notebook_smoke_test
            base_parameters:
              env: ${bundle.target}
          # Use an existing all-purpose cluster for smoke tests.
          # The cluster ID is injected at runtime by the pipeline
          # via the Databricks Jobs API when needed.
          # For bundle-run, this will use the default cluster resolution
          # (job cluster or existing cluster depending on workspace policy).
